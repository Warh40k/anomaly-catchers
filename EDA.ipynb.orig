{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import datetime\n",
    "from tqdm import tqdm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext2 = pd.read_csv('Датасет\\\\db2\\\\Ext2.csv')\n",
    "ext1 = pd.read_csv('Датасет\\\\db2\\\\Ext.csv')\n",
    "catch = pd.read_csv('Датасет\\\\db1\\\\catch.csv') \n",
    "product = pd.read_csv('Датасет\\\\db1\\\\product.csv') "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Общая предобработка"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext1.rename(columns={'id_fishery':'id_ves'}, inplace=True)\n",
    "#ext1.loc[ext1.Product_period == '\\\\N', 'Product_period'] = np.NaN\n",
    "# ext1.loc[ext1.Name_Plat == '\\\\N', 'Name_Plat'] = np.NaN\n",
    "# ext1_mrg = ext1.merge(ext2, on='id_vsd', how='left')\n",
    "catch.date = pd.to_datetime(catch.date)\n",
    "product.date = pd.to_datetime(product.date)\n",
    "ext1.date_fishery = pd.to_datetime(ext1.date_fishery) \n",
    "# ext1.Product_period = pd.to_datetime(ext1.Product_period) \n",
    "ext2.date_vsd = pd.to_datetime(ext2.date_vsd) \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Возьмем данные за 10 последних дней"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count                          3115280\n",
       "mean     2022-02-27 04:59:18.038428160\n",
       "min                2022-01-01 00:39:56\n",
       "25%                2022-02-01 09:19:24\n",
       "50%         2022-02-26 22:52:32.500000\n",
       "75%                2022-03-25 07:20:31\n",
       "max                2022-05-25 12:57:22\n",
       "Name: date_vsd, dtype: object"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext2.date_vsd.describe(datetime_is_numeric=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count                            85087\n",
       "mean     2022-02-27 11:19:51.904756480\n",
       "min                2022-01-01 00:00:00\n",
       "25%                2022-02-01 00:00:00\n",
       "50%                2022-03-01 00:00:00\n",
       "75%                2022-03-27 00:00:00\n",
       "max                2022-04-20 00:00:00\n",
       "Name: date, dtype: object"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "catch.date.describe(datetime_is_numeric=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "samp_1 = ext1[(ext1.date_fishery >= pd.to_datetime('2022-04-15')) & (ext1.date_fishery <= pd.to_datetime('2022-04-20'))]\n",
    "samp_2 = ext2[(ext2.date_vsd >= pd.to_datetime('2022-04-15')) & (ext2.date_vsd <= pd.to_datetime('2022-04-20'))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method NDFrame.head of          id_ves   id_own date_fishery numPart  id_Plat   id_vsd Name_Plat  \\\n",
       "0       1540707  3760885   2022-04-20      \\N  4917985  7014527        \\N   \n",
       "1       1540707  3760885   2022-04-20      \\N  4917985  6354585        \\N   \n",
       "2       1540707  3760885   2022-04-20      \\N  4917985  8911428        \\N   \n",
       "3       1540707  3760885   2022-04-20      \\N  4917985  5128035        \\N   \n",
       "4       1540707  3760885   2022-04-20      \\N  4917985  6334115        \\N   \n",
       "...         ...      ...          ...     ...      ...      ...       ...   \n",
       "150726  2270107  6377225   2022-04-15      \\N  6958521  3826703        \\N   \n",
       "150727  2270107  6377225   2022-04-15      \\N  6958521  8653969        \\N   \n",
       "150728  2270107  6377225   2022-04-15      \\N  6958521  8653969        \\N   \n",
       "150729  2270107  6377225   2022-04-15      \\N  6958521  8697691        \\N   \n",
       "150730  2270107  6377225   2022-04-15      \\N  6958521  8697691        \\N   \n",
       "\n",
       "       Product_period Region_Plat    num_vsd  id_fish          fish  \\\n",
       "0                  \\N          \\N        NaN      NaN           NaN   \n",
       "1                  \\N          \\N        NaN      NaN           NaN   \n",
       "2                  \\N          \\N        NaN      NaN           NaN   \n",
       "3                  \\N          \\N        NaN      NaN           NaN   \n",
       "4                  \\N          \\N        NaN      NaN           NaN   \n",
       "...               ...         ...        ...      ...           ...   \n",
       "150726             \\N          \\N   682761.0     -1.0       камбала   \n",
       "150727             \\N          \\N  1387902.0    292.0        треска   \n",
       "150728             \\N          \\N  1387902.0     -1.0        треска   \n",
       "150729             \\N          \\N  6719697.0    677.0         бычки   \n",
       "150730             \\N          \\N  6719697.0     -1.0  бычок свежий   \n",
       "\n",
       "                  date_vsd   volume   unit  \n",
       "0                      NaT      NaN    NaN  \n",
       "1                      NaT      NaN    NaN  \n",
       "2                      NaT      NaN    NaN  \n",
       "3                      NaT      NaN    NaN  \n",
       "4                      NaT      NaN    NaN  \n",
       "...                    ...      ...    ...  \n",
       "150726 2022-04-19 01:11:14     58.0  тонна  \n",
       "150727 2022-04-19 01:11:13  23466.0     \\N  \n",
       "150728 2022-04-19 01:11:13     23.0  тонна  \n",
       "150729 2022-04-19 01:11:14   3846.0     \\N  \n",
       "150730 2022-04-19 01:11:14      4.0  тонна  \n",
       "\n",
       "[150731 rows x 15 columns]>"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "samp_1.merge(samp_2, on='id_vsd', how='left').head"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Обработка дубликатов ext2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "# print(ext2[ext2.duplicated('id_vsd', keep=False)].sort_values(by=['id_vsd', 'date_vsd']).shape[0])\n",
    "# print(ext2.shape[0])\n",
    "# print(3115280 - 91708 / 2)\n",
    "def drop_dup_ext2(df):\n",
    "    ext2 = df.copy()\n",
    "    ext2['abs_error'] = 0\n",
    "    tmp = ext2[ext2.duplicated('id_vsd', keep=False)]\n",
    "    drop_idx = tmp.sort_values(by=['id_vsd', 'unit']).index[1::2]\n",
    "    good_idx = tmp.sort_values(by=['id_vsd', 'unit']).index[::2]\n",
    "    ext2.loc[drop_idx, 'abs_error'] = abs(ext2.loc[drop_idx, 'volume'].values * 1000 - ext2.loc[good_idx, 'volume'].values)\n",
    "    tmp.sort_values(by=['id_vsd', 'date_vsd'])\n",
    "    ext2.drop((tmp.loc[drop_idx, 'abs_error'] > 500).index).shape\n",
    "    ext2 = ext2.drop((tmp.loc[drop_idx, 'abs_error'] > 500).index)\n",
    "    return ext2\n",
    "\n",
    "samp_2 = drop_dup_ext2(samp_2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Обработка дубликатов ext1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [],
   "source": [
    "def drop_dup_ext1(df):\n",
    "    ext1 = df.copy()\n",
    "    tmp = ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves'])\n",
    "    change_idx = ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves']).index\n",
    "    ext1.loc[change_idx, 'Product_period'] = (tmp.Product_period + ' - ' + tmp.date_fishery.astype(str)).values\n",
    "    drop_idx = ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves']).index\n",
    "    ext1 = ext1.drop(drop_idx[1::2])\n",
    "    return ext1\n",
    "\n",
    "samp_1 = drop_dup_ext1(samp_1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "1",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-126-b2a11b737325>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[0mmy\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m{\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 2\u001b[1;33m \u001b[0mmy\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m2\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      3\u001b[0m \u001b[0mmy\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 1"
     ]
    }
   ],
   "source": [
    "my = {}\n",
    "my[1][2] = 2\n",
    "my"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "          id_vsd             date_vsd  volume   unit    fish\n",
      "3093668  5496794  2022-04-15 07:14:17       3     кг  треска\n",
      "2951336  8354870  2022-04-18 00:08:04       3  тонна  треска\n",
      "23\n"
     ]
    }
   ],
   "source": [
    "json_file='repeat_report_anomaly.json'\n",
    "with open(json_file, encoding='utf8') as f:\n",
    "    test = json.load(f, encoding='utf8')['repeat_report']\n",
    "    print(pd.DataFrame(eval(test['violation'][0])))\n",
    "    print(len(test['violation']) + len(test['mistake']))\n",
    "# Машиночитаемый вид\n",
    "# with open(json_file, 'r', encoding='utf8') as f:\n",
    "#     print(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(144617, 143696)"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "samp_1.shape[0], samp_2.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "samp_1_mrg = samp_1.merge(samp_2, on='id_vsd', how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 293,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>fish</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>94771</th>\n",
       "      <td>5405316</td>\n",
       "      <td>7273837</td>\n",
       "      <td>-1</td>\n",
       "      <td>густера мороженая</td>\n",
       "      <td>2022-03-29 13:11:48</td>\n",
       "      <td>2188</td>\n",
       "      <td>тонна</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id_vsd  num_vsd  id_fish               fish            date_vsd  \\\n",
       "94771  5405316  7273837       -1  густера мороженая 2022-03-29 13:11:48   \n",
       "\n",
       "       volume   unit  \n",
       "94771    2188  тонна  "
      ]
     },
     "execution_count": 293,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext2[(ext2.volume == 2188) & (ext2.unit == 'тонна')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 305,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(Timestamp('2022-03-28 04:46:07'), Timestamp('2022-03-28 04:46:07'))"
      ]
     },
     "execution_count": 305,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp.iloc[i:i+2].date_vsd.iloc[0], tmp.iloc[i:i+2].date_vsd.iloc[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Timedelta' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-307-f4451da80ca6>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mTimedelta\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'0 days 00:00:00'\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m: name 'Timedelta' is not defined"
     ]
    }
   ],
   "source": [
    "Timedelta('0 days 00:00:00')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp = samp_2[samp_2.volume > 0].sort_values(by='volume')\n",
    "lines = tmp.iloc[3:3+2]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>fish</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>abs_error</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2783292</th>\n",
       "      <td>7935482</td>\n",
       "      <td>1309498</td>\n",
       "      <td>-1</td>\n",
       "      <td>кольца кальмара в кляре</td>\n",
       "      <td>2022-04-16 07:04:47</td>\n",
       "      <td>1</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2783296</th>\n",
       "      <td>2752190</td>\n",
       "      <td>5170480</td>\n",
       "      <td>-1</td>\n",
       "      <td>сельдь соленая</td>\n",
       "      <td>2022-04-16 07:04:47</td>\n",
       "      <td>1</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd  num_vsd  id_fish                     fish  \\\n",
       "2783292  7935482  1309498       -1  кольца кальмара в кляре   \n",
       "2783296  2752190  5170480       -1           сельдь соленая   \n",
       "\n",
       "                   date_vsd  volume unit  abs_error  \n",
       "2783292 2022-04-16 07:04:47       1   кг          0  \n",
       "2783296 2022-04-16 07:04:47       1   кг          0  "
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lines"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import json"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'violation': ['{\"id_vsd\":{\"3093668\":5496794,\"2951336\":8354870},\"date_vsd\":{\"3093668\":1650006857000,\"2951336\":1650240484000}}',\n",
       "  '{\"id_vsd\":{\"2759008\":2392276,\"3080549\":6196911},\"date_vsd\":{\"2759008\":1650184945000,\"3080549\":1649989790000}}',\n",
       "  '{\"id_vsd\":{\"2668950\":6707691,\"2781329\":8835985},\"date_vsd\":{\"2668950\":1649991517000,\"2781329\":1649991798000}}',\n",
       "  '{\"id_vsd\":{\"2781307\":8487193,\"2670040\":2093504},\"date_vsd\":{\"2781307\":1650168344000,\"2670040\":1650173485000}}',\n",
       "  '{\"id_vsd\":{\"2670816\":4967027,\"3049226\":9340176},\"date_vsd\":{\"2670816\":1650336046000,\"3049226\":1650337342000}}',\n",
       "  '{\"id_vsd\":{\"2670403\":1732995,\"3049253\":9177127},\"date_vsd\":{\"2670403\":1650250031000,\"3049253\":1650250947000}}',\n",
       "  '{\"id_vsd\":{\"3050040\":2333775,\"2669523\":7831397},\"date_vsd\":{\"3050040\":1650093671000,\"2669523\":1650084856000}}',\n",
       "  '{\"id_vsd\":{\"3049230\":6642545,\"2670049\":146214},\"date_vsd\":{\"3049230\":1650168011000,\"2670049\":1650180176000}}',\n",
       "  '{\"id_vsd\":{\"2669365\":7747480,\"2948789\":570067},\"date_vsd\":{\"2669365\":1650079560000,\"2948789\":1649994954000}}',\n",
       "  '{\"id_vsd\":{\"2670039\":4736584,\"3050047\":2081374},\"date_vsd\":{\"2670039\":1650173484000,\"3050047\":1650167735000}}',\n",
       "  '{\"id_vsd\":{\"2669420\":9233841,\"3049299\":3864311},\"date_vsd\":{\"2669420\":1650081296000,\"3049299\":1650093995000}}',\n",
       "  '{\"id_vsd\":{\"2668711\":6759599,\"2948011\":5963410},\"date_vsd\":{\"2668711\":1649984421000,\"2948011\":1649994398000}}',\n",
       "  '{\"id_vsd\":{\"2781192\":6734324,\"2669516\":602322},\"date_vsd\":{\"2781192\":1650250393000,\"2669516\":1650084854000}}',\n",
       "  '{\"id_vsd\":{\"2670025\":8572046,\"2781205\":8000308},\"date_vsd\":{\"2670025\":1650173481000,\"2781205\":1650250430000}}',\n",
       "  '{\"id_vsd\":{\"2915596\":5154676,\"2669301\":3874590},\"date_vsd\":{\"2915596\":1650340799000,\"2669301\":1650074199000}}',\n",
       "  '{\"id_vsd\":{\"2668719\":418842,\"2948039\":5366184},\"date_vsd\":{\"2668719\":1649986419000,\"2948039\":1649994181000}}',\n",
       "  '{\"id_vsd\":{\"2948778\":9056773,\"2668707\":2017340},\"date_vsd\":{\"2948778\":1649993943000,\"2668707\":1649986284000}}',\n",
       "  '{\"id_vsd\":{\"2668709\":135374,\"2948790\":5828776},\"date_vsd\":{\"2668709\":1649986283000,\"2948790\":1649993943000}}'],\n",
       " 'mistake': ['{\"id_vsd\":{\"2670433\":9079062,\"2781331\":165569},\"date_vsd\":{\"2670433\":1650251654000,\"2781331\":1650251447000}}',\n",
       "  '{\"id_vsd\":{\"2670402\":535443,\"3050035\":8560460},\"date_vsd\":{\"2670402\":1650251653000,\"3050035\":1650250428000}}',\n",
       "  '{\"id_vsd\":{\"2948027\":2676308,\"2669369\":6239637},\"date_vsd\":{\"2948027\":1649995168000,\"2669369\":1650079567000}}',\n",
       "  '{\"id_vsd\":{\"2668868\":2495004,\"2781206\":6814161},\"date_vsd\":{\"2668868\":1649993261000,\"2781206\":1650250376000}}',\n",
       "  '{\"id_vsd\":{\"3049330\":8369117,\"2668899\":2334911},\"date_vsd\":{\"3049330\":1649991331000,\"2668899\":1649989931000}}']}"
      ]
     },
     "execution_count": 71,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "anomaly_dict"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('test.txt', 'w', encoding='utf8') as f:\n",
    "        print(f'Задержки в пределах допустимого:\\n', file=f)\n",
    "        for line in anomaly_dict['mistake']:\n",
    "            tmp = json.loads(line)\n",
    "            print(pd.DataFrame(tmp).reset_index(drop=True), file=f) \n",
    "        print(file=f)\n",
    "        print('-' * 40, file=f)\n",
    "        print(file=f)\n",
    "        print(f'Задержки больше {1} часа(ов):\\n', file=f)\n",
    "        for line in anomaly_dict['violation']:\n",
    "            tmp = json.loads(line)\n",
    "            print(pd.DataFrame(tmp).reset_index(drop=True), file=f)\n",
    "\n",
    "       "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": [
    "test = json.loads(line)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>date_vsd</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2670433</th>\n",
       "      <td>9079062</td>\n",
       "      <td>1650251654000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2781331</th>\n",
       "      <td>165569</td>\n",
       "      <td>1650251447000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd       date_vsd\n",
       "2670433  9079062  1650251654000\n",
       "2781331   165569  1650251447000"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame(test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "Object of type DataFrame is not JSON serializable",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-61-a903db2852ec>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[1;32mwith\u001b[0m \u001b[0mopen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'result.json'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'w'\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;32mas\u001b[0m \u001b[0mfp\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 2\u001b[1;33m     \u001b[0mjson\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdump\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0manomaly_dict\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mfp\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\__init__.py\u001b[0m in \u001b[0;36mdump\u001b[1;34m(obj, fp, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, default, sort_keys, **kw)\u001b[0m\n\u001b[0;32m    177\u001b[0m     \u001b[1;31m# could accelerate with writelines in some versions of Python, at\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    178\u001b[0m     \u001b[1;31m# a debuggability cost\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 179\u001b[1;33m     \u001b[1;32mfor\u001b[0m \u001b[0mchunk\u001b[0m \u001b[1;32min\u001b[0m \u001b[0miterable\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    180\u001b[0m         \u001b[0mfp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mwrite\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mchunk\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    181\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode\u001b[1;34m(o, _current_indent_level)\u001b[0m\n\u001b[0;32m    429\u001b[0m             \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0m_iterencode_list\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    430\u001b[0m         \u001b[1;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mdict\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 431\u001b[1;33m             \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0m_iterencode_dict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    432\u001b[0m         \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    433\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0mmarkers\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode_dict\u001b[1;34m(dct, _current_indent_level)\u001b[0m\n\u001b[0;32m    403\u001b[0m                 \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    404\u001b[0m                     \u001b[0mchunks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mvalue\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 405\u001b[1;33m                 \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0mchunks\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    406\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mnewline_indent\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    407\u001b[0m             \u001b[0m_current_indent_level\u001b[0m \u001b[1;33m-=\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode_list\u001b[1;34m(lst, _current_indent_level)\u001b[0m\n\u001b[0;32m    323\u001b[0m                 \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    324\u001b[0m                     \u001b[0mchunks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mvalue\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 325\u001b[1;33m                 \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0mchunks\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    326\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mnewline_indent\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    327\u001b[0m             \u001b[0m_current_indent_level\u001b[0m \u001b[1;33m-=\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode\u001b[1;34m(o, _current_indent_level)\u001b[0m\n\u001b[0;32m    436\u001b[0m                     \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Circular reference detected\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    437\u001b[0m                 \u001b[0mmarkers\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mmarkerid\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mo\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 438\u001b[1;33m             \u001b[0mo\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_default\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    439\u001b[0m             \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    440\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0mmarkers\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36mdefault\u001b[1;34m(self, o)\u001b[0m\n\u001b[0;32m    177\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    178\u001b[0m         \"\"\"\n\u001b[1;32m--> 179\u001b[1;33m         raise TypeError(f'Object of type {o.__class__.__name__} '\n\u001b[0m\u001b[0;32m    180\u001b[0m                         f'is not JSON serializable')\n\u001b[0;32m    181\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: Object of type DataFrame is not JSON serializable"
     ]
    }
   ],
   "source": [
    "with open('result.json', 'w') as fp:\n",
    "    json.dump(anomaly_dict, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('report_delays.json', 'w', encoding='utf8') as f:\n",
    "    json.dump(anomaly_dict, f, ensure_ascii=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "for key in anomaly_dict:\n",
    "    for i in range(len(anomaly_dict[key])):\n",
    "        anomaly_dict[key][i] = anomaly_dict[key][i].to_json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 132616/132616 [02:07<00:00, 1037.16it/s]\n"
     ]
    },
    {
     "ename": "TypeError",
     "evalue": "Object of type DataFrame is not JSON serializable",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-55-4f491ceba696>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m     16\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mc1\u001b[0m \u001b[1;33m&\u001b[0m \u001b[0mc2\u001b[0m \u001b[1;33m&\u001b[0m \u001b[0mc4\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;32mand\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mc3\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     17\u001b[0m             \u001b[0manomaly_dict\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'violation'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlines\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'id_vsd'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'date_vsd'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 18\u001b[1;33m     \u001b[0mjson\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdump\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0manomaly_dict\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mf\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\__init__.py\u001b[0m in \u001b[0;36mdump\u001b[1;34m(obj, fp, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, default, sort_keys, **kw)\u001b[0m\n\u001b[0;32m    177\u001b[0m     \u001b[1;31m# could accelerate with writelines in some versions of Python, at\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    178\u001b[0m     \u001b[1;31m# a debuggability cost\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 179\u001b[1;33m     \u001b[1;32mfor\u001b[0m \u001b[0mchunk\u001b[0m \u001b[1;32min\u001b[0m \u001b[0miterable\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    180\u001b[0m         \u001b[0mfp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mwrite\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mchunk\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    181\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode\u001b[1;34m(o, _current_indent_level)\u001b[0m\n\u001b[0;32m    429\u001b[0m             \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0m_iterencode_list\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    430\u001b[0m         \u001b[1;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mdict\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 431\u001b[1;33m             \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0m_iterencode_dict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    432\u001b[0m         \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    433\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0mmarkers\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode_dict\u001b[1;34m(dct, _current_indent_level)\u001b[0m\n\u001b[0;32m    403\u001b[0m                 \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    404\u001b[0m                     \u001b[0mchunks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mvalue\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 405\u001b[1;33m                 \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0mchunks\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    406\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mnewline_indent\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    407\u001b[0m             \u001b[0m_current_indent_level\u001b[0m \u001b[1;33m-=\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode_list\u001b[1;34m(lst, _current_indent_level)\u001b[0m\n\u001b[0;32m    323\u001b[0m                 \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    324\u001b[0m                     \u001b[0mchunks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mvalue\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 325\u001b[1;33m                 \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0mchunks\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    326\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mnewline_indent\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    327\u001b[0m             \u001b[0m_current_indent_level\u001b[0m \u001b[1;33m-=\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36m_iterencode\u001b[1;34m(o, _current_indent_level)\u001b[0m\n\u001b[0;32m    436\u001b[0m                     \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Circular reference detected\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    437\u001b[0m                 \u001b[0mmarkers\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mmarkerid\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mo\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 438\u001b[1;33m             \u001b[0mo\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_default\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    439\u001b[0m             \u001b[1;32myield\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mo\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_current_indent_level\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    440\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0mmarkers\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\json\\encoder.py\u001b[0m in \u001b[0;36mdefault\u001b[1;34m(self, o)\u001b[0m\n\u001b[0;32m    177\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    178\u001b[0m         \"\"\"\n\u001b[1;32m--> 179\u001b[1;33m         raise TypeError(f'Object of type {o.__class__.__name__} '\n\u001b[0m\u001b[0;32m    180\u001b[0m                         f'is not JSON serializable')\n\u001b[0;32m    181\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: Object of type DataFrame is not JSON serializable"
     ]
    }
   ],
   "source": [
    "# ext2[(ext2.volume == 2188) & (ext2.unit == 'кг')]\n",
    "with open('report_delays.json', 'w', encoding='utf8') as f:\n",
    "    anomaly_dict = {'violation':[], 'mistake':[]}\n",
    "    tmp = samp_2[samp_2.volume > 0].sort_values(by='volume')\n",
    "    for i in tqdm(range(tmp.shape[0] - 1)):\n",
    "        lines = tmp.iloc[i:i+2]\n",
    "        c1 = lines.volume.iloc[0] == lines.volume.iloc[1]\n",
    "        c2 = lines.unit.iloc[0] != lines.unit.iloc[1]\n",
    "        c3 = pd.Timedelta(lines.date_vsd.iloc[0] - lines.date_vsd.iloc[1]).seconds / 3600.0 < 1\n",
    "        c4 = lines.fish.iloc[0] == lines.fish.iloc[1]\n",
    "        if c1 & c2 & c3 & c4:\n",
    "            # print(c1, c2, c3, c4) \n",
    "            anomaly_dict['mistake'].append(lines[['id_vsd', 'date_vsd']].to_json())          \n",
    "            # print(lines[['id_vsd', 'date_vsd'].iloc[0])\n",
    "            # print(lines[['id_vsd', 'date_vsd']].iloc[1])\n",
    "        if (c1 & c2 & c4) and not c3:\n",
    "            anomaly_dict['violation'].append(lines[['id_vsd', 'date_vsd']].to_json())          \n",
    "    json.dump(anomaly_dict, f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>date_vsd</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2670433</th>\n",
       "      <td>9079062</td>\n",
       "      <td>1650251654000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2781331</th>\n",
       "      <td>165569</td>\n",
       "      <td>1650251447000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd       date_vsd\n",
       "2670433  9079062  1650251654000\n",
       "2781331   165569  1650251447000"
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame(json.loads(anomaly_dict['mistake'][0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>fish</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>abs_error</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>94771</th>\n",
       "      <td>5405316</td>\n",
       "      <td>7273837</td>\n",
       "      <td>-1</td>\n",
       "      <td>густера мороженая</td>\n",
       "      <td>2022-03-29 13:11:48</td>\n",
       "      <td>2188</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>107902</th>\n",
       "      <td>4488272</td>\n",
       "      <td>7055462</td>\n",
       "      <td>-1</td>\n",
       "      <td>филе судака мороженое</td>\n",
       "      <td>2022-03-09 16:42:52</td>\n",
       "      <td>20</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>254378</th>\n",
       "      <td>1227657</td>\n",
       "      <td>8793958</td>\n",
       "      <td>-1</td>\n",
       "      <td>пелядь</td>\n",
       "      <td>2022-02-25 12:26:49</td>\n",
       "      <td>6</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269218</th>\n",
       "      <td>7350225</td>\n",
       "      <td>9369478</td>\n",
       "      <td>-1</td>\n",
       "      <td>карась мороженый</td>\n",
       "      <td>2022-04-04 10:51:37</td>\n",
       "      <td>0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>269220</th>\n",
       "      <td>9059526</td>\n",
       "      <td>4154769</td>\n",
       "      <td>-1</td>\n",
       "      <td>окунь мороженый</td>\n",
       "      <td>2022-04-04 10:51:37</td>\n",
       "      <td>0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3083830</th>\n",
       "      <td>8890850</td>\n",
       "      <td>7229351</td>\n",
       "      <td>-1</td>\n",
       "      <td>треска</td>\n",
       "      <td>2022-04-06 13:36:04</td>\n",
       "      <td>26</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3083831</th>\n",
       "      <td>4933135</td>\n",
       "      <td>6695747</td>\n",
       "      <td>-1</td>\n",
       "      <td>камбала-ерш охлажденная</td>\n",
       "      <td>2022-04-06 13:36:05</td>\n",
       "      <td>1</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3083833</th>\n",
       "      <td>6175541</td>\n",
       "      <td>3611984</td>\n",
       "      <td>-1</td>\n",
       "      <td>палтус</td>\n",
       "      <td>2022-04-06 13:36:05</td>\n",
       "      <td>0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3083837</th>\n",
       "      <td>8518574</td>\n",
       "      <td>509199</td>\n",
       "      <td>-1</td>\n",
       "      <td>зубатка свежая</td>\n",
       "      <td>2022-04-06 13:36:05</td>\n",
       "      <td>1</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3099325</th>\n",
       "      <td>544515</td>\n",
       "      <td>7528287</td>\n",
       "      <td>-1</td>\n",
       "      <td>судак мороженый</td>\n",
       "      <td>2022-04-11 14:11:12</td>\n",
       "      <td>12</td>\n",
       "      <td>тонна</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7375 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd  num_vsd  id_fish                     fish  \\\n",
       "94771    5405316  7273837       -1        густера мороженая   \n",
       "107902   4488272  7055462       -1    филе судака мороженое   \n",
       "254378   1227657  8793958       -1                   пелядь   \n",
       "269218   7350225  9369478       -1         карась мороженый   \n",
       "269220   9059526  4154769       -1          окунь мороженый   \n",
       "...          ...      ...      ...                      ...   \n",
       "3083830  8890850  7229351       -1                   треска   \n",
       "3083831  4933135  6695747       -1  камбала-ерш охлажденная   \n",
       "3083833  6175541  3611984       -1                   палтус   \n",
       "3083837  8518574   509199       -1           зубатка свежая   \n",
       "3099325   544515  7528287       -1          судак мороженый   \n",
       "\n",
       "                   date_vsd  volume   unit  abs_error  \n",
       "94771   2022-03-29 13:11:48    2188  тонна          0  \n",
       "107902  2022-03-09 16:42:52      20  тонна          0  \n",
       "254378  2022-02-25 12:26:49       6  тонна          0  \n",
       "269218  2022-04-04 10:51:37       0  тонна          0  \n",
       "269220  2022-04-04 10:51:37       0  тонна          0  \n",
       "...                     ...     ...    ...        ...  \n",
       "3083830 2022-04-06 13:36:04      26  тонна          0  \n",
       "3083831 2022-04-06 13:36:05       1  тонна          0  \n",
       "3083833 2022-04-06 13:36:05       0  тонна          0  \n",
       "3083837 2022-04-06 13:36:05       1  тонна          0  \n",
       "3099325 2022-04-11 14:11:12      12  тонна          0  \n",
       "\n",
       "[7375 rows x 8 columns]"
      ]
     },
     "execution_count": 249,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ton_idx = ext2[ext2.unit == 'тонна'].index\n",
    "ext2.loc[ton_idx]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 268,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>fish</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>abs_error</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>961884</th>\n",
       "      <td>1952005</td>\n",
       "      <td>2138203</td>\n",
       "      <td>-1</td>\n",
       "      <td>лосось натуральный</td>\n",
       "      <td>2022-01-02 01:21:33</td>\n",
       "      <td>1</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>961885</th>\n",
       "      <td>8251392</td>\n",
       "      <td>7493666</td>\n",
       "      <td>-1</td>\n",
       "      <td>лосось натуральный</td>\n",
       "      <td>2022-01-02 01:21:33</td>\n",
       "      <td>1</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1723508</th>\n",
       "      <td>6886695</td>\n",
       "      <td>5071236</td>\n",
       "      <td>-1</td>\n",
       "      <td>изделия кулинарные рыбные</td>\n",
       "      <td>2022-01-02 01:22:05</td>\n",
       "      <td>2</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1723509</th>\n",
       "      <td>1907676</td>\n",
       "      <td>1460236</td>\n",
       "      <td>-1</td>\n",
       "      <td>изделия кулинарные рыбные</td>\n",
       "      <td>2022-01-02 01:22:05</td>\n",
       "      <td>2</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1723519</th>\n",
       "      <td>1413232</td>\n",
       "      <td>7702684</td>\n",
       "      <td>-1</td>\n",
       "      <td>изделия кулинарные рыбные</td>\n",
       "      <td>2022-01-02 01:22:05</td>\n",
       "      <td>4</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2841252</th>\n",
       "      <td>561759</td>\n",
       "      <td>660306</td>\n",
       "      <td>-1</td>\n",
       "      <td>сельдь соленая</td>\n",
       "      <td>2022-04-20 02:36:51</td>\n",
       "      <td>0</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2841253</th>\n",
       "      <td>558424</td>\n",
       "      <td>5743965</td>\n",
       "      <td>-1</td>\n",
       "      <td>сельдь соленая</td>\n",
       "      <td>2022-04-20 02:36:51</td>\n",
       "      <td>0</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2841254</th>\n",
       "      <td>5068567</td>\n",
       "      <td>2080052</td>\n",
       "      <td>-1</td>\n",
       "      <td>сельдь соленая</td>\n",
       "      <td>2022-04-20 02:36:51</td>\n",
       "      <td>0</td>\n",
       "      <td>кг</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3106340</th>\n",
       "      <td>823729</td>\n",
       "      <td>2287068</td>\n",
       "      <td>457</td>\n",
       "      <td>корюшка азиатская зубастая</td>\n",
       "      <td>2022-05-06 12:43:34</td>\n",
       "      <td>402</td>\n",
       "      <td>\\N</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3106341</th>\n",
       "      <td>4393300</td>\n",
       "      <td>6989766</td>\n",
       "      <td>457</td>\n",
       "      <td>корюшка азиатская зубастая</td>\n",
       "      <td>2022-05-06 12:43:34</td>\n",
       "      <td>402</td>\n",
       "      <td>\\N</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>291864 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd  num_vsd  id_fish                        fish  \\\n",
       "961884   1952005  2138203       -1          лосось натуральный   \n",
       "961885   8251392  7493666       -1          лосось натуральный   \n",
       "1723508  6886695  5071236       -1   изделия кулинарные рыбные   \n",
       "1723509  1907676  1460236       -1   изделия кулинарные рыбные   \n",
       "1723519  1413232  7702684       -1   изделия кулинарные рыбные   \n",
       "...          ...      ...      ...                         ...   \n",
       "2841252   561759   660306       -1              сельдь соленая   \n",
       "2841253   558424  5743965       -1              сельдь соленая   \n",
       "2841254  5068567  2080052       -1              сельдь соленая   \n",
       "3106340   823729  2287068      457  корюшка азиатская зубастая   \n",
       "3106341  4393300  6989766      457  корюшка азиатская зубастая   \n",
       "\n",
       "                   date_vsd  volume unit  abs_error  \n",
       "961884  2022-01-02 01:21:33       1   кг          0  \n",
       "961885  2022-01-02 01:21:33       1   кг          0  \n",
       "1723508 2022-01-02 01:22:05       2   кг          0  \n",
       "1723509 2022-01-02 01:22:05       2   кг          0  \n",
       "1723519 2022-01-02 01:22:05       4   кг          0  \n",
       "...                     ...     ...  ...        ...  \n",
       "2841252 2022-04-20 02:36:51       0   кг          0  \n",
       "2841253 2022-04-20 02:36:51       0   кг          0  \n",
       "2841254 2022-04-20 02:36:51       0   кг          0  \n",
       "3106340 2022-05-06 12:43:34     402   \\N          0  \n",
       "3106341 2022-05-06 12:43:34     402   \\N          0  \n",
       "\n",
       "[291864 rows x 8 columns]"
      ]
     },
     "execution_count": 268,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp = ext2[ext2.duplicated(['fish', 'volume', 'date_vsd'], keep=False)].sort_values(by=['date_vsd', 'volume'])\n",
    "tmp\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 260,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "834151     True\n",
       "2213807    True\n",
       "2213828    True\n",
       "2213831    True\n",
       "2213840    True\n",
       "           ... \n",
       "2913221    True\n",
       "741127     True\n",
       "671277     True\n",
       "2911392    True\n",
       "2911391    True\n",
       "Name: unit, Length: 2866074, dtype: bool"
      ]
     },
     "execution_count": 260,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(tmp.unit == 'кг') | (tmp.unit == '\\\\N')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3069426"
      ]
     },
     "execution_count": 118,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3069426"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#ext2[ext2.duplicated('id_vsd', keep=False)].sort_values(by=['id_vsd', 'date_vsd']).head(4)\n",
    "#tmp = ext2[ext2.duplicated('id_vsd', keep=False)]\n",
    "#tmp[(tmp.unit == 'тонна') & (tmp.id_fish == -1)]91708 \n",
    "#tmp.sort_values(by=['id_vsd', 'unit'])  #keep = first\n",
    "ext2.sort_values(by=['id_vsd', 'unit']).drop_duplicates('id_vsd', keep='first').shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>id_own</th>\n",
       "      <th>date_fishery</th>\n",
       "      <th>numPart</th>\n",
       "      <th>id_Plat</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>Name_Plat</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>Region_Plat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>539959</th>\n",
       "      <td>2337731</td>\n",
       "      <td>4743567</td>\n",
       "      <td>2022-04-03 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2352176</td>\n",
       "      <td>71</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>523999</th>\n",
       "      <td>-1</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-04-04 02:41:41</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2352176</td>\n",
       "      <td>71</td>\n",
       "      <td>858685</td>\n",
       "      <td>2022-04-03 00:00:00</td>\n",
       "      <td>Мурманская область</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>653036</th>\n",
       "      <td>1147871</td>\n",
       "      <td>4565284</td>\n",
       "      <td>2022-03-30 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>743924</td>\n",
       "      <td>534</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>617757</th>\n",
       "      <td>-1</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-03-31 03:08:31</td>\n",
       "      <td>\\N</td>\n",
       "      <td>743924</td>\n",
       "      <td>534</td>\n",
       "      <td>7635039</td>\n",
       "      <td>2022-03-30 00:00:00</td>\n",
       "      <td>Сахалинская область</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id_ves   id_own        date_fishery numPart  id_Plat  id_vsd  \\\n",
       "539959  2337731  4743567 2022-04-03 00:00:00      \\N  2352176      71   \n",
       "523999       -1  5502023 2022-04-04 02:41:41      \\N  2352176      71   \n",
       "653036  1147871  4565284 2022-03-30 00:00:00      \\N   743924     534   \n",
       "617757       -1  5502023 2022-03-31 03:08:31      \\N   743924     534   \n",
       "\n",
       "       Name_Plat       Product_period          Region_Plat  \n",
       "539959       NaN                  NaN                   \\N  \n",
       "523999    858685  2022-04-03 00:00:00   Мурманская область  \n",
       "653036       NaN                  NaN                   \\N  \n",
       "617757   7635039  2022-03-30 00:00:00  Сахалинская область  "
      ]
     },
     "execution_count": 163,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'date_fishery']).head(4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 217,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext1 = ext1.drop(drop_idx[1::2])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>id_own</th>\n",
       "      <th>date_fishery</th>\n",
       "      <th>numPart</th>\n",
       "      <th>id_Plat</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>Name_Plat</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>Region_Plat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>523999</th>\n",
       "      <td>2337731.0</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-04-04 02:41:41</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2352176</td>\n",
       "      <td>71</td>\n",
       "      <td>858685</td>\n",
       "      <td>2022-04-03 00:00:00</td>\n",
       "      <td>Мурманская область</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>539959</th>\n",
       "      <td>2337731.0</td>\n",
       "      <td>4743567</td>\n",
       "      <td>2022-04-03 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2352176</td>\n",
       "      <td>71</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>617757</th>\n",
       "      <td>1147871.0</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-03-31 03:08:31</td>\n",
       "      <td>\\N</td>\n",
       "      <td>743924</td>\n",
       "      <td>534</td>\n",
       "      <td>7635039</td>\n",
       "      <td>2022-03-30 00:00:00</td>\n",
       "      <td>Сахалинская область</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>653036</th>\n",
       "      <td>1147871.0</td>\n",
       "      <td>4565284</td>\n",
       "      <td>2022-03-30 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>743924</td>\n",
       "      <td>534</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>161959</th>\n",
       "      <td>2181156.0</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-04-15 01:33:39</td>\n",
       "      <td>\\N</td>\n",
       "      <td>484587</td>\n",
       "      <td>610</td>\n",
       "      <td>5068711</td>\n",
       "      <td>\\N</td>\n",
       "      <td>Мурманская область</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1968241</th>\n",
       "      <td>4543391.0</td>\n",
       "      <td>2507472</td>\n",
       "      <td>2022-02-14 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2975925</td>\n",
       "      <td>9520583</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2368612</th>\n",
       "      <td>3200620.0</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-01-31 10:36:30</td>\n",
       "      <td>\\N</td>\n",
       "      <td>4646693</td>\n",
       "      <td>9520820</td>\n",
       "      <td>1878350</td>\n",
       "      <td>2022-01-30 00:00:00</td>\n",
       "      <td>Мурманская область</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2401139</th>\n",
       "      <td>3200620.0</td>\n",
       "      <td>8379463</td>\n",
       "      <td>2022-01-30 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>4646693</td>\n",
       "      <td>9520820</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2608611</th>\n",
       "      <td>2634670.0</td>\n",
       "      <td>5502023</td>\n",
       "      <td>2022-01-23 02:33:04</td>\n",
       "      <td>\\N</td>\n",
       "      <td>8805052</td>\n",
       "      <td>9520874</td>\n",
       "      <td>6312932</td>\n",
       "      <td>2022-01-22 00:00:00</td>\n",
       "      <td>Мурманская область</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2623616</th>\n",
       "      <td>2634670.0</td>\n",
       "      <td>9405992</td>\n",
       "      <td>2022-01-22 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>8805052</td>\n",
       "      <td>9520874</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>91708 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            id_ves   id_own        date_fishery numPart  id_Plat   id_vsd  \\\n",
       "523999   2337731.0  5502023 2022-04-04 02:41:41      \\N  2352176       71   \n",
       "539959   2337731.0  4743567 2022-04-03 00:00:00      \\N  2352176       71   \n",
       "617757   1147871.0  5502023 2022-03-31 03:08:31      \\N   743924      534   \n",
       "653036   1147871.0  4565284 2022-03-30 00:00:00      \\N   743924      534   \n",
       "161959   2181156.0  5502023 2022-04-15 01:33:39      \\N   484587      610   \n",
       "...            ...      ...                 ...     ...      ...      ...   \n",
       "1968241  4543391.0  2507472 2022-02-14 00:00:00      \\N  2975925  9520583   \n",
       "2368612  3200620.0  5502023 2022-01-31 10:36:30      \\N  4646693  9520820   \n",
       "2401139  3200620.0  8379463 2022-01-30 00:00:00      \\N  4646693  9520820   \n",
       "2608611  2634670.0  5502023 2022-01-23 02:33:04      \\N  8805052  9520874   \n",
       "2623616  2634670.0  9405992 2022-01-22 00:00:00      \\N  8805052  9520874   \n",
       "\n",
       "        Name_Plat       Product_period          Region_Plat  \n",
       "523999     858685  2022-04-03 00:00:00   Мурманская область  \n",
       "539959         \\N                   \\N                   \\N  \n",
       "617757    7635039  2022-03-30 00:00:00  Сахалинская область  \n",
       "653036         \\N                   \\N                   \\N  \n",
       "161959    5068711                   \\N   Мурманская область  \n",
       "...           ...                  ...                  ...  \n",
       "1968241        \\N                   \\N                   \\N  \n",
       "2368612   1878350  2022-01-30 00:00:00   Мурманская область  \n",
       "2401139        \\N                   \\N                   \\N  \n",
       "2608611   6312932  2022-01-22 00:00:00   Мурманская область  \n",
       "2623616        \\N                   \\N                   \\N  \n",
       "\n",
       "[91708 rows x 9 columns]"
      ]
     },
     "execution_count": 206,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change_idx = ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves']).index\n",
    "ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "metadata": {},
   "outputs": [],
   "source": [
    "tmp = ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves'])\n",
    "change_idx = ext1[ext1.duplicated(['id_vsd'], keep=False)].sort_values(by=['id_vsd', 'id_ves']).index\n",
    "ext1.loc[change_idx, 'Product_period'] = (tmp.Product_period + ' - ' + tmp.date_fishery.astype(str)).values\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>id_own</th>\n",
       "      <th>date_fishery</th>\n",
       "      <th>numPart</th>\n",
       "      <th>id_Plat</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>Name_Plat</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>Region_Plat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>652968</th>\n",
       "      <td>9472820</td>\n",
       "      <td>4565284</td>\n",
       "      <td>2022-03-30</td>\n",
       "      <td>\\N</td>\n",
       "      <td>685187</td>\n",
       "      <td>7525317</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>653035</th>\n",
       "      <td>1875749</td>\n",
       "      <td>4565284</td>\n",
       "      <td>2022-03-30</td>\n",
       "      <td>\\N</td>\n",
       "      <td>1707704</td>\n",
       "      <td>5600915</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>653036</th>\n",
       "      <td>1147871</td>\n",
       "      <td>4565284</td>\n",
       "      <td>2022-03-30</td>\n",
       "      <td>\\N</td>\n",
       "      <td>743924</td>\n",
       "      <td>534</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>653037</th>\n",
       "      <td>2807166</td>\n",
       "      <td>4565284</td>\n",
       "      <td>2022-03-30</td>\n",
       "      <td>\\N</td>\n",
       "      <td>1874</td>\n",
       "      <td>9235148</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id_ves   id_own date_fishery numPart  id_Plat   id_vsd Name_Plat  \\\n",
       "652968  9472820  4565284   2022-03-30      \\N   685187  7525317        \\N   \n",
       "653035  1875749  4565284   2022-03-30      \\N  1707704  5600915        \\N   \n",
       "653036  1147871  4565284   2022-03-30      \\N   743924      534        \\N   \n",
       "653037  2807166  4565284   2022-03-30      \\N     1874  9235148        \\N   \n",
       "\n",
       "       Product_period Region_Plat  \n",
       "652968             \\N          \\N  \n",
       "653035             \\N          \\N  \n",
       "653036             \\N          \\N  \n",
       "653037             \\N          \\N  "
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext1[(ext1.id_own == 4565284) & (ext1.date_fishery == pd.to_datetime('2022-03-30'))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>fish</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>36732</th>\n",
       "      <td>7525317</td>\n",
       "      <td>4185775</td>\n",
       "      <td>859</td>\n",
       "      <td>креветка северная</td>\n",
       "      <td>2022-03-31 02:05:21</td>\n",
       "      <td>1076</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1517049</th>\n",
       "      <td>7525317</td>\n",
       "      <td>4185775</td>\n",
       "      <td>-1</td>\n",
       "      <td>креветка северная</td>\n",
       "      <td>2022-03-31 02:05:21</td>\n",
       "      <td>1</td>\n",
       "      <td>тонна</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd  num_vsd  id_fish               fish            date_vsd  \\\n",
       "36732    7525317  4185775      859  креветка северная 2022-03-31 02:05:21   \n",
       "1517049  7525317  4185775       -1  креветка северная 2022-03-31 02:05:21   \n",
       "\n",
       "         volume   unit  \n",
       "36732      1076     \\N  \n",
       "1517049       1  тонна  "
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext2[(ext2.id_vsd == 7525317) & (ext2.date_vsd >= pd.to_datetime('2022-03-30'))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 220,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>id_region</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_regime</th>\n",
       "      <th>permit</th>\n",
       "      <th>id_own</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [id_ves, date, id_region, id_fish, catch_volume, id_regime, permit, id_own]\n",
       "Index: []"
      ]
     },
     "execution_count": 220,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "catch[(catch.id_own == 5502023)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext2.unit=='тонна'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [],
   "source": [
    "dfx = pd.DataFrame(range(1, 6)) # 1, 2, 3, 4, 5\n",
    "dfx = dfx.rolling(3).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     0\n",
       "0  NaN\n",
       "1  NaN\n",
       "2  2.0\n",
       "3  3.0\n",
       "4  4.0"
      ]
     },
     "execution_count": 86,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfx"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext2_simp_ = pd.read_csv('Упрощённый датасет\\\\db2\\\\Ext2.csv')\n",
    "ext1_simp_ = pd.read_csv('Упрощённый датасет\\\\db2\\\\Ext.csv')\n",
    "catch_simp_ = pd.read_csv('Упрощённый датасет\\\\db1\\\\catch.csv') \n",
    "product_simp_ = pd.read_csv('Упрощённый датасет\\\\db1\\\\product.csv') "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext1_mrg = ext1.merge(ext2, on='id_vsd', how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['id_vsd', 'num_vsd', 'id_fish', 'fish', 'date_vsd', 'volume', 'unit'], dtype='object')"
      ]
     },
     "execution_count": 155,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext2_simp_.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'ext1_mrg' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-8-b2db4b4382c6>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[0mcatch\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mto_datetime\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mcatch\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[0mproduct\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mto_datetime\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mproduct\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 4\u001b[1;33m \u001b[0mext1_mrg\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate_fishery\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mto_datetime\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mext1_mrg\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate_fishery\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      5\u001b[0m \u001b[0mext1_mrg\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate_vsd\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mto_datetime\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mext1_mrg\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdate_vsd\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mNameError\u001b[0m: name 'ext1_mrg' is not defined"
     ]
    }
   ],
   "source": [
    "ext1.rename(columns={'id_fishery':'id_ves'}, inplace=True)\n",
    "catch.date = pd.to_datetime(catch.date)\n",
    "product.date = pd.to_datetime(product.date)\n",
    "ext1_mrg.date_fishery = pd.to_datetime(ext1_mrg.date_fishery) \n",
    "ext1_mrg.date_vsd = pd.to_datetime(ext1_mrg.date_vsd) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 244,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext1cols = ['id_vsd', 'id_ves', 'id_own', 'date_fishery', 'Product_period']\n",
    "ext2cols = ['id_vsd', 'date_vsd', 'volume', 'unit', 'fish']\n",
    "catchcols = ['id_ves', 'date', 'catch_volume', 'id_own']\n",
    "productcols = ['id_ves', 'date', 'id_prod_designate', 'id_prod_type', 'prod_volume', 'prod_board_volume']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext2_simp = ext2_simp_[ext2cols]\n",
    "ext1_simp = ext1_simp_[ext1cols]\n",
    "catch_simp = catch_simp_[catchcols]\n",
    "product_simp = product_simp_[productcols]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 247,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext2 = ext2_[ext2cols]\n",
    "ext1 = ext1_[ext1cols]\n",
    "catch = catch_[catchcols]\n",
    "product = product_[productcols]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((3260798, 5), (3115280, 4), (85087, 4), (395071, 6))"
      ]
     },
     "execution_count": 99,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext1_simp.shape, ext2_simp.shape, catch_simp.shape, product_simp.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Здесь проверим несостыковки для тех кораблей, что есть во всех таблицах"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 248,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ext1_simp_mrg = ext1_simp.merge(ext2_simp, on='id_vsd', how='left')\n",
    "ext1_mrg = ext1.merge(ext2, on='id_vsd', how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "c:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py:5494: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  self[name] = value\n"
     ]
    }
   ],
   "source": [
    "# catch_simp.date = pd.to_datetime(catch_simp.date)\n",
    "# product_simp.date = pd.to_datetime(product_simp.date)\n",
    "# ext1_simp_mrg.date_fishery = pd.to_datetime(ext1_simp_mrg.date_fishery) \n",
    "# ext1_simp_mrg.date_vsd = pd.to_datetime(ext1_simp_mrg.date_vsd) \n",
    "\n",
    "catch.date = pd.to_datetime(catch.date)\n",
    "product.date = pd.to_datetime(product.date)\n",
    "ext1_mrg.date_fishery = pd.to_datetime(ext1_mrg.date_fishery) \n",
    "ext1_mrg.date_vsd = pd.to_datetime(ext1_mrg.date_vsd) \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 250,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ext1_simp_mrg.rename(columns={'date_fishery':'date'}, inplace=True)\n",
    "ext1_mrg.rename(columns={'date_fishery':'date'}, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 254,
   "metadata": {},
   "outputs": [],
   "source": [
    "# idx = list(set(catch_simp.id_ves) & set(product_simp.id_ves) & set(ext1_simp_mrg.id_ves))\n",
    "idx_orig = list(set(catch.id_ves) & set(ext1_mrg.id_ves))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  0%|          | 0/326 [00:00<?, ?it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  1%|          | 3/326 [00:00<00:11, 27.03it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  2%|▏         | 6/326 [00:00<00:12, 25.76it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  3%|▎         | 9/326 [00:00<00:11, 26.75it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  4%|▎         | 12/326 [00:00<00:11, 27.02it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  5%|▍         | 16/326 [00:00<00:11, 28.12it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  6%|▌         | 19/326 [00:00<00:10, 28.09it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  7%|▋         | 22/326 [00:00<00:11, 27.04it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  8%|▊         | 25/326 [00:00<00:11, 26.17it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "  9%|▊         | 28/326 [00:01<00:11, 25.67it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 10%|▉         | 32/326 [00:01<00:10, 27.06it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 11%|█         | 35/326 [00:01<00:10, 27.47it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 12%|█▏        | 38/326 [00:01<00:10, 27.06it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 13%|█▎        | 41/326 [00:01<00:10, 26.81it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 14%|█▍        | 45/326 [00:01<00:10, 28.04it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 15%|█▍        | 48/326 [00:01<00:09, 28.18it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 16%|█▌        | 51/326 [00:01<00:10, 27.18it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 17%|█▋        | 54/326 [00:02<00:10, 26.26it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 17%|█▋        | 57/326 [00:02<00:11, 23.84it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 18%|█▊        | 60/326 [00:02<00:11, 22.51it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 19%|█▉        | 63/326 [00:02<00:11, 23.12it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 21%|██        | 67/326 [00:02<00:10, 25.46it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 22%|██▏       | 71/326 [00:02<00:09, 26.85it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 23%|██▎       | 74/326 [00:02<00:09, 27.30it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 24%|██▎       | 77/326 [00:02<00:09, 26.43it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 25%|██▍       | 80/326 [00:03<00:09, 27.27it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 25%|██▌       | 83/326 [00:03<00:09, 26.79it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 26%|██▋       | 86/326 [00:03<00:08, 27.58it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 27%|██▋       | 89/326 [00:03<00:08, 27.85it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 28%|██▊       | 92/326 [00:03<00:08, 28.22it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 29%|██▉       | 96/326 [00:03<00:07, 29.16it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 30%|███       | 99/326 [00:03<00:07, 28.54it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 31%|███▏      | 102/326 [00:03<00:07, 28.86it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 32%|███▏      | 105/326 [00:03<00:07, 28.69it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 33%|███▎      | 108/326 [00:03<00:07, 28.58it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 34%|███▍      | 111/326 [00:04<00:07, 28.58it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 35%|███▍      | 114/326 [00:04<00:07, 28.49it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 36%|███▌      | 118/326 [00:04<00:07, 28.65it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 37%|███▋      | 121/326 [00:04<00:07, 28.89it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 38%|███▊      | 124/326 [00:04<00:06, 29.03it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 39%|███▉      | 128/326 [00:04<00:06, 29.66it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 40%|████      | 131/326 [00:04<00:06, 28.67it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 41%|████      | 134/326 [00:04<00:06, 28.02it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 42%|████▏     | 137/326 [00:05<00:06, 27.87it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 43%|████▎     | 141/326 [00:05<00:06, 29.11it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 44%|████▍     | 144/326 [00:05<00:06, 28.89it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 45%|████▌     | 148/326 [00:05<00:06, 26.66it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 46%|████▋     | 151/326 [00:05<00:06, 26.37it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 47%|████▋     | 154/326 [00:05<00:06, 26.89it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 48%|████▊     | 157/326 [00:05<00:06, 25.43it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 49%|████▉     | 160/326 [00:05<00:06, 26.16it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 50%|█████     | 163/326 [00:05<00:06, 26.68it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 51%|█████     | 166/326 [00:06<00:05, 27.24it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 52%|█████▏    | 170/326 [00:06<00:05, 28.24it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 53%|█████▎    | 173/326 [00:06<00:05, 28.32it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 54%|█████▍    | 176/326 [00:06<00:05, 28.55it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 55%|█████▍    | 179/326 [00:06<00:05, 28.94it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 56%|█████▌    | 182/326 [00:06<00:04, 29.08it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 57%|█████▋    | 186/326 [00:06<00:04, 29.56it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 58%|█████▊    | 189/326 [00:06<00:04, 28.20it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 59%|█████▉    | 192/326 [00:07<00:04, 27.67it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 60%|█████▉    | 195/326 [00:07<00:04, 27.91it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 61%|██████    | 199/326 [00:07<00:04, 29.08it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 62%|██████▏   | 202/326 [00:07<00:04, 29.33it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 63%|██████▎   | 205/326 [00:07<00:04, 27.89it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 64%|██████▍   | 208/326 [00:07<00:04, 28.06it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 65%|██████▍   | 211/326 [00:07<00:04, 28.52it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 66%|██████▌   | 214/326 [00:07<00:03, 28.13it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 67%|██████▋   | 217/326 [00:07<00:03, 27.48it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 67%|██████▋   | 220/326 [00:07<00:03, 27.94it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 68%|██████▊   | 223/326 [00:08<00:03, 28.28it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 70%|██████▉   | 227/326 [00:08<00:03, 29.20it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 71%|███████   | 230/326 [00:08<00:03, 28.79it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 71%|███████▏  | 233/326 [00:08<00:03, 27.44it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 72%|███████▏  | 236/326 [00:08<00:03, 28.07it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 73%|███████▎  | 239/326 [00:08<00:03, 27.97it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 74%|███████▍  | 242/326 [00:08<00:03, 27.92it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 75%|███████▌  | 245/326 [00:08<00:02, 28.43it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 76%|███████▌  | 248/326 [00:08<00:02, 28.79it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 77%|███████▋  | 252/326 [00:09<00:02, 29.43it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 78%|███████▊  | 255/326 [00:09<00:02, 28.79it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 79%|███████▉  | 258/326 [00:09<00:02, 28.80it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 80%|████████  | 261/326 [00:09<00:02, 28.43it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 81%|████████  | 264/326 [00:09<00:02, 27.33it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 82%|████████▏ | 267/326 [00:09<00:02, 27.45it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 83%|████████▎ | 270/326 [00:09<00:01, 28.06it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 84%|████████▎ | 273/326 [00:09<00:01, 27.89it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 85%|████████▍ | 276/326 [00:10<00:02, 24.12it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 86%|████████▌ | 279/326 [00:10<00:02, 22.71it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 87%|████████▋ | 282/326 [00:10<00:01, 24.06it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 87%|████████▋ | 285/326 [00:10<00:01, 24.82it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 88%|████████▊ | 288/326 [00:10<00:01, 25.75it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 89%|████████▉ | 291/326 [00:10<00:01, 26.26it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 90%|█████████ | 295/326 [00:10<00:01, 27.89it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 91%|█████████▏| 298/326 [00:10<00:01, 27.50it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 92%|█████████▏| 301/326 [00:10<00:00, 28.09it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 94%|█████████▎| 305/326 [00:11<00:00, 28.98it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 94%|█████████▍| 308/326 [00:11<00:00, 25.74it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 95%|█████████▌| 311/326 [00:11<00:00, 26.62it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 96%|█████████▋| 314/326 [00:11<00:00, 26.46it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 97%|█████████▋| 317/326 [00:11<00:00, 27.25it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 98%|█████████▊| 320/326 [00:11<00:00, 27.98it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      " 99%|█████████▉| 323/326 [00:11<00:00, 27.38it/s]<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "<ipython-input-210-3c705a00e097>:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
      "100%|██████████| 326/326 [00:11<00:00, 27.44it/s]\n"
     ]
    }
   ],
   "source": [
    "# errors = []\n",
    "# for ves in tqdm(idx):\n",
    "#     a1 = catch_simp[catch_simp.id_ves == ves]\n",
    "#     a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
    "#     a2 = ext1_simp_mrg[ext1_simp_mrg.id_ves == ves]\n",
    "#     a2 = a2.drop_duplicates(['date', 'id_ves', 'id_vsd'], 'first')\n",
    "#     a2['first_dig'] = a2.volume.astype(str).str.slice(0, 2)\n",
    "\n",
    "#     df1 = a1.merge(a2, on=['id_ves', 'date', 'first_dig'], how='right')\n",
    "#     kilo_idx = df1[df1.unit == '\\\\N'].index\n",
    "#     df1.loc[kilo_idx, 'volume'] = df1.volume / 1000\n",
    "#     df1 = df1.dropna()\n",
    "#     df1['error'] = 1 - df1.catch_volume / df1.volume\n",
    "#     if not df1[df1['error']>0.05].empty:\n",
    "#         errors.append(df1[df1['error']>0.05])\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 261,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 261,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list(set(catch.id_ves) & set(ext1.id_ves))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 252,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "0it [00:00, ?it/s]\n"
     ]
    }
   ],
   "source": [
    "errors = []\n",
    "for ves in tqdm(idx_orig):\n",
    "    a1 = catch[catch.id_ves == ves]\n",
    "    a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
    "    a2 = ext1_mrg[ext1_mrg.id_ves == ves]\n",
    "    a2 = a2.drop_duplicates(['date', 'id_ves', 'id_vsd'], 'first')\n",
    "    a2['first_dig'] = a2.volume.astype(str).str.slice(0, 2)\n",
    "\n",
    "    df1 = a1.merge(a2, on=['id_ves', 'date', 'first_dig'], how='right')\n",
    "    kilo_idx = df1[df1.unit == '\\\\N'].index\n",
    "    df1.loc[kilo_idx, 'volume'] = df1.volume / 1000\n",
    "    df1 = df1.dropna()\n",
    "    df1['error'] = 1 - df1.catch_volume / df1.volume\n",
    "    if not df1[df1['error']>0.05].empty:\n",
    "        errors.append(df1[df1['error']>0.05])\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 230,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "numpy.datetime64('2022-03-08T00:00:00.000000000')"
      ]
     },
     "execution_count": 230,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "errors[0].date.values[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>48493</th>\n",
       "      <td>1286</td>\n",
       "      <td>2022-03-08</td>\n",
       "      <td>11.535</td>\n",
       "      <td>1091</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48494</th>\n",
       "      <td>1286</td>\n",
       "      <td>2022-03-08</td>\n",
       "      <td>114.239</td>\n",
       "      <td>1091</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id_ves       date  catch_volume  id_own\n",
       "48493    1286 2022-03-08        11.535    1091\n",
       "48494    1286 2022-03-08       114.239    1091"
      ]
     },
     "execution_count": 231,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "catch_simp[(catch_simp.id_ves == errors[0].id_ves.values[0]) & (catch_simp.date==errors[0].date.values[0])]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4\n",
      "2\n",
      "0\n",
      "------------------------------\n",
      "10\n",
      "5\n",
      "1\n",
      "------------------------------\n",
      "10\n",
      "5\n",
      "2\n",
      "------------------------------\n",
      "10\n",
      "5\n",
      "3\n",
      "------------------------------\n",
      "4\n",
      "2\n",
      "4\n",
      "------------------------------\n",
      "4\n",
      "2\n",
      "5\n",
      "------------------------------\n",
      "8\n",
      "4\n",
      "6\n",
      "------------------------------\n",
      "8\n",
      "4\n",
      "7\n",
      "------------------------------\n",
      "4\n",
      "2\n",
      "8\n",
      "------------------------------\n",
      "8\n",
      "4\n",
      "9\n",
      "------------------------------\n",
      "4\n",
      "2\n",
      "10\n",
      "------------------------------\n"
     ]
    }
   ],
   "source": [
    "for i in range(len(errors)):\n",
    "    len_ext = ext1_simp_mrg[(ext1_simp_mrg.id_ves == errors[i].id_ves.values[0]) & (ext1_simp_mrg.date==errors[i].date.values[0])].shape[0]\n",
    "    len_catch = catch_simp[(catch_simp.id_ves == errors[i].id_ves.values[0]) & (catch_simp.date==errors[i].date.values[0])].shape[0]\n",
    "    if len_ext // 2 != len_catch:\n",
    "        print(i)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>31.874</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>376</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-01-02</td>\n",
       "      <td>80.147</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2107</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-01-05</td>\n",
       "      <td>10.149</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2728</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-01-06</td>\n",
       "      <td>208.182</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3373</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-01-07</td>\n",
       "      <td>150.686</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64062</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-28</td>\n",
       "      <td>120.047</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64836</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-29</td>\n",
       "      <td>111.789</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65565</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-30</td>\n",
       "      <td>196.385</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66360</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-31</td>\n",
       "      <td>14.902</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67293</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-04-01</td>\n",
       "      <td>8.004</td>\n",
       "      <td>961</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>87 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       id_ves       date  catch_volume  id_own\n",
       "0        1628 2022-01-01        31.874     961\n",
       "376      1628 2022-01-02        80.147     961\n",
       "2107     1628 2022-01-05        10.149     961\n",
       "2728     1628 2022-01-06       208.182     961\n",
       "3373     1628 2022-01-07       150.686     961\n",
       "...       ...        ...           ...     ...\n",
       "64062    1628 2022-03-28       120.047     961\n",
       "64836    1628 2022-03-29       111.789     961\n",
       "65565    1628 2022-03-30       196.385     961\n",
       "66360    1628 2022-03-31        14.902     961\n",
       "67293    1628 2022-04-01         8.004     961\n",
       "\n",
       "[87 rows x 4 columns]"
      ]
     },
     "execution_count": 135,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "catch_simp[catch_simp.id_ves == 1628]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 204,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-204-0d2333eaa64e>:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own_x</th>\n",
       "      <th>first_dig</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>id_own_y</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>fish</th>\n",
       "      <th>error</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>171</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-04-17</td>\n",
       "      <td>0.379500</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7599412</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-04-18 03:44:38</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>палтус черный свежий</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>172</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-04-17</td>\n",
       "      <td>0.028050</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7599412</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-04-18 03:44:38</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>палтус черный свежий</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-04-17</td>\n",
       "      <td>0.125400</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7599412</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-04-18 03:44:38</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>палтус черный свежий</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>174</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-04-17</td>\n",
       "      <td>0.768000</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7599412</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-04-18 03:44:38</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>палтус черный свежий</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-04-17</td>\n",
       "      <td>0.177480</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7599412</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-04-18 03:44:38</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>палтус черный свежий</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1274</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>0.091022</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>8511941</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-02 05:13:01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>зубатка свежая</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1275</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>0.393763</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7031948</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-02 05:13:02</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>камбала</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1276</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>0.681767</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7031948</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-02 05:13:02</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>камбала</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1277</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>0.063296</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7031948</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-02 05:13:02</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>камбала</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1278</th>\n",
       "      <td>1284</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>0.091022</td>\n",
       "      <td>1047.0</td>\n",
       "      <td>0.</td>\n",
       "      <td>7031948</td>\n",
       "      <td>1047</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-02 05:13:02</td>\n",
       "      <td>0.0</td>\n",
       "      <td>тонна</td>\n",
       "      <td>камбала</td>\n",
       "      <td>-inf</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>984 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      id_ves       date  catch_volume  id_own_x first_dig   id_vsd  id_own_y  \\\n",
       "171     1284 2022-04-17      0.379500    1047.0        0.  7599412      1047   \n",
       "172     1284 2022-04-17      0.028050    1047.0        0.  7599412      1047   \n",
       "173     1284 2022-04-17      0.125400    1047.0        0.  7599412      1047   \n",
       "174     1284 2022-04-17      0.768000    1047.0        0.  7599412      1047   \n",
       "175     1284 2022-04-17      0.177480    1047.0        0.  7599412      1047   \n",
       "...      ...        ...           ...       ...       ...      ...       ...   \n",
       "1274    1284 2022-01-01      0.091022    1047.0        0.  8511941      1047   \n",
       "1275    1284 2022-01-01      0.393763    1047.0        0.  7031948      1047   \n",
       "1276    1284 2022-01-01      0.681767    1047.0        0.  7031948      1047   \n",
       "1277    1284 2022-01-01      0.063296    1047.0        0.  7031948      1047   \n",
       "1278    1284 2022-01-01      0.091022    1047.0        0.  7031948      1047   \n",
       "\n",
       "     Product_period            date_vsd  volume   unit                  fish  \\\n",
       "171              \\N 2022-04-18 03:44:38     0.0  тонна  палтус черный свежий   \n",
       "172              \\N 2022-04-18 03:44:38     0.0  тонна  палтус черный свежий   \n",
       "173              \\N 2022-04-18 03:44:38     0.0  тонна  палтус черный свежий   \n",
       "174              \\N 2022-04-18 03:44:38     0.0  тонна  палтус черный свежий   \n",
       "175              \\N 2022-04-18 03:44:38     0.0  тонна  палтус черный свежий   \n",
       "...             ...                 ...     ...    ...                   ...   \n",
       "1274             \\N 2022-01-02 05:13:01     0.0  тонна        зубатка свежая   \n",
       "1275             \\N 2022-01-02 05:13:02     0.0  тонна               камбала   \n",
       "1276             \\N 2022-01-02 05:13:02     0.0  тонна               камбала   \n",
       "1277             \\N 2022-01-02 05:13:02     0.0  тонна               камбала   \n",
       "1278             \\N 2022-01-02 05:13:02     0.0  тонна               камбала   \n",
       "\n",
       "      error  \n",
       "171    -inf  \n",
       "172    -inf  \n",
       "173    -inf  \n",
       "174    -inf  \n",
       "175    -inf  \n",
       "...     ...  \n",
       "1274   -inf  \n",
       "1275   -inf  \n",
       "1276   -inf  \n",
       "1277   -inf  \n",
       "1278   -inf  \n",
       "\n",
       "[984 rows x 13 columns]"
      ]
     },
     "execution_count": 204,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# a1 = catch_simp[catch_simp.id_ves == 1284]\n",
    "# a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
    "# a2 = ext1_simp_mrg[ext1_simp_mrg.id_ves == 1284]\n",
    "# a2 = a2.drop_duplicates(['date', 'id_ves', 'id_vsd'], 'last')\n",
    "# a2['first_dig'] = a2.volume.astype(str).str.slice(0, 2)\n",
    "\n",
    "# df1 = a1.merge(a2, on=['id_ves', 'date', 'first_dig'], how='right')\n",
    "# kilo_idx = df1[df1.unit == '\\\\N'].index\n",
    "# df1.loc[kilo_idx, 'volume'] = df1.volume / 1000\n",
    "# df1 = df1.dropna()\n",
    "# df1['error'] = 1 - df1.catch_volume / df1.volume\n",
    "# df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-239-e7c822338680>:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own</th>\n",
       "      <th>first_dig</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>53244</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>31.449</td>\n",
       "      <td>961</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53245</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>58.858</td>\n",
       "      <td>961</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id_ves       date  catch_volume  id_own first_dig\n",
       "53244    1628 2022-03-14        31.449     961        31\n",
       "53245    1628 2022-03-14        58.858     961        58"
      ]
     },
     "execution_count": 239,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a1 = catch_simp[(catch_simp.id_ves == 1628) & (catch_simp.date==pd.to_datetime(datetime.date(2022, 3, 14)))]\n",
    "a1['first_dig'] = a1.catch_volume.astype(str).str.slice(0, 2)\n",
    "\n",
    "a1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>id_ves</th>\n",
       "      <th>id_own</th>\n",
       "      <th>date</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>fish</th>\n",
       "      <th>first_dig</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1164446</th>\n",
       "      <td>7492878</td>\n",
       "      <td>1628</td>\n",
       "      <td>961</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-03-15 01:18:03</td>\n",
       "      <td>58858.0</td>\n",
       "      <td>\\N</td>\n",
       "      <td>минтай</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1164448</th>\n",
       "      <td>9168097</td>\n",
       "      <td>1628</td>\n",
       "      <td>961</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-03-15 01:18:02</td>\n",
       "      <td>31449.0</td>\n",
       "      <td>\\N</td>\n",
       "      <td>минтай</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd  id_ves  id_own       date Product_period  \\\n",
       "1164446  7492878    1628     961 2022-03-14             \\N   \n",
       "1164448  9168097    1628     961 2022-03-14             \\N   \n",
       "\n",
       "                   date_vsd   volume unit    fish first_dig  \n",
       "1164446 2022-03-15 01:18:03  58858.0   \\N  минтай        58  \n",
       "1164448 2022-03-15 01:18:02  31449.0   \\N  минтай        31  "
      ]
     },
     "execution_count": 188,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a2 = ext1_simp_mrg[(ext1_simp_mrg.id_ves == 1628) & (ext1_simp_mrg.date==pd.to_datetime(datetime.date(2022, 3, 14)))]\n",
    "a2 = a2.drop_duplicates(['date', 'id_ves', 'id_vsd'])\n",
    "a2['first_dig'] = a2.volume.astype(str).str.slice(0, 2)\n",
    "a2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own_x</th>\n",
       "      <th>first_dig</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>id_own_y</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>fish</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>58.858</td>\n",
       "      <td>961</td>\n",
       "      <td>58</td>\n",
       "      <td>7492878</td>\n",
       "      <td>961</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-03-15 01:18:03</td>\n",
       "      <td>58858.0</td>\n",
       "      <td>\\N</td>\n",
       "      <td>минтай</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>31.449</td>\n",
       "      <td>961</td>\n",
       "      <td>31</td>\n",
       "      <td>9168097</td>\n",
       "      <td>961</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-03-15 01:18:02</td>\n",
       "      <td>31449.0</td>\n",
       "      <td>\\N</td>\n",
       "      <td>минтай</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_ves       date  catch_volume  id_own_x first_dig   id_vsd  id_own_y  \\\n",
       "0    1628 2022-03-14        58.858       961        58  7492878       961   \n",
       "1    1628 2022-03-14        31.449       961        31  9168097       961   \n",
       "\n",
       "  Product_period            date_vsd   volume unit    fish  \n",
       "0             \\N 2022-03-15 01:18:03  58858.0   \\N  минтай  \n",
       "1             \\N 2022-03-15 01:18:02  31449.0   \\N  минтай  "
      ]
     },
     "execution_count": 191,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a1.merge(a2, on=['id_ves', 'date','first_dig'], how='right')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own_x</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>id_own_y</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>fish</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>31.449</td>\n",
       "      <td>961</td>\n",
       "      <td>7492878</td>\n",
       "      <td>961</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-03-15 01:18:03</td>\n",
       "      <td>58858.0</td>\n",
       "      <td>\\N</td>\n",
       "      <td>минтай</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1628</td>\n",
       "      <td>2022-03-14</td>\n",
       "      <td>31.449</td>\n",
       "      <td>961</td>\n",
       "      <td>9168097</td>\n",
       "      <td>961</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-03-15 01:18:02</td>\n",
       "      <td>31449.0</td>\n",
       "      <td>\\N</td>\n",
       "      <td>минтай</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_ves       date  catch_volume  id_own_x   id_vsd  id_own_y  \\\n",
       "0    1628 2022-03-14        31.449       961  7492878       961   \n",
       "2    1628 2022-03-14        31.449       961  9168097       961   \n",
       "\n",
       "  Product_period            date_vsd   volume unit    fish  \n",
       "0             \\N 2022-03-15 01:18:03  58858.0   \\N  минтай  \n",
       "2             \\N 2022-03-15 01:18:02  31449.0   \\N  минтай  "
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a1.merge(a2, on=['id_ves', 'date']).drop_duplicates(['date', 'id_ves', 'id_vsd'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_own_x</th>\n",
       "      <th>first_dig</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>id_own_y</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>fish</th>\n",
       "      <th>error</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [id_ves, date, catch_volume, id_own_x, first_dig, id_vsd, id_own_y, Product_period, date_vsd, volume, unit, fish, error]\n",
       "Index: []"
      ]
     },
     "execution_count": 197,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1[df1.error > 0.1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "697"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "set(catch_simp.id_ves) & set(product_simp.id_ves)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "catch_prod_mrg = product_simp.merge(catch_simp, on='id_ves', how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "catch_prod_mrg.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext2.date_vsd = pd.to_datetime(ext2.date_vsd)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_id = catch.id_own.iloc[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>id_region</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_regime</th>\n",
       "      <th>permit</th>\n",
       "      <th>id_own</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>84248</th>\n",
       "      <td>2024908</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>400</td>\n",
       "      <td>10.442</td>\n",
       "      <td>1</td>\n",
       "      <td>2351477</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84249</th>\n",
       "      <td>2024908</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>403</td>\n",
       "      <td>14.093</td>\n",
       "      <td>1</td>\n",
       "      <td>2351477</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84250</th>\n",
       "      <td>2024908</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>451</td>\n",
       "      <td>14.692</td>\n",
       "      <td>1</td>\n",
       "      <td>2351477</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84251</th>\n",
       "      <td>2024908</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>457</td>\n",
       "      <td>0.209</td>\n",
       "      <td>97</td>\n",
       "      <td>2351477</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84252</th>\n",
       "      <td>3965387</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>273</td>\n",
       "      <td>849</td>\n",
       "      <td>4.573</td>\n",
       "      <td>1</td>\n",
       "      <td>4877462</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84296</th>\n",
       "      <td>8270286</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>267</td>\n",
       "      <td>692</td>\n",
       "      <td>30.299</td>\n",
       "      <td>1</td>\n",
       "      <td>3454942</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84309</th>\n",
       "      <td>2701764</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>400</td>\n",
       "      <td>10.531</td>\n",
       "      <td>1</td>\n",
       "      <td>5925461</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84310</th>\n",
       "      <td>2701764</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>403</td>\n",
       "      <td>13.642</td>\n",
       "      <td>1</td>\n",
       "      <td>5925461</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84311</th>\n",
       "      <td>2701764</td>\n",
       "      <td>2022-04-20</td>\n",
       "      <td>274</td>\n",
       "      <td>451</td>\n",
       "      <td>15.276</td>\n",
       "      <td>1</td>\n",
       "      <td>5925461</td>\n",
       "      <td>7115834</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id_ves        date  id_region  id_fish  catch_volume  id_regime  \\\n",
       "84248  2024908  2022-04-20        274      400        10.442          1   \n",
       "84249  2024908  2022-04-20        274      403        14.093          1   \n",
       "84250  2024908  2022-04-20        274      451        14.692          1   \n",
       "84251  2024908  2022-04-20        274      457         0.209         97   \n",
       "84252  3965387  2022-04-20        273      849         4.573          1   \n",
       "84296  8270286  2022-04-20        267      692        30.299          1   \n",
       "84309  2701764  2022-04-20        274      400        10.531          1   \n",
       "84310  2701764  2022-04-20        274      403        13.642          1   \n",
       "84311  2701764  2022-04-20        274      451        15.276          1   \n",
       "\n",
       "        permit   id_own  \n",
       "84248  2351477  7115834  \n",
       "84249  2351477  7115834  \n",
       "84250  2351477  7115834  \n",
       "84251  2351477  7115834  \n",
       "84252  4877462  7115834  \n",
       "84296  3454942  7115834  \n",
       "84309  5925461  7115834  \n",
       "84310  5925461  7115834  \n",
       "84311  5925461  7115834  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "catch[(catch.id_own == test_id) & (catch.date.str.contains('2022-04-20'))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_fishery</th>\n",
       "      <th>id_own</th>\n",
       "      <th>date_fishery</th>\n",
       "      <th>numPart</th>\n",
       "      <th>id_Plat</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>Name_Plat</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>Region_Plat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>16689</th>\n",
       "      <td>7244716</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>7127846</td>\n",
       "      <td>326315</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16690</th>\n",
       "      <td>7244716</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>7127846</td>\n",
       "      <td>3527650</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16691</th>\n",
       "      <td>7244716</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>7127846</td>\n",
       "      <td>2233380</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16692</th>\n",
       "      <td>7244716</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>7127846</td>\n",
       "      <td>2912231</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16693</th>\n",
       "      <td>5868605</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2403603</td>\n",
       "      <td>9466358</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16694</th>\n",
       "      <td>3487610</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>4899079</td>\n",
       "      <td>401394</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16729</th>\n",
       "      <td>867437</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6996629</td>\n",
       "      <td>3734122</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16730</th>\n",
       "      <td>867437</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6996629</td>\n",
       "      <td>4000204</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16731</th>\n",
       "      <td>867437</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-04-20 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6996629</td>\n",
       "      <td>3338879</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id_fishery   id_own         date_fishery numPart  id_Plat   id_vsd  \\\n",
       "16689     7244716  7115834  2022-04-20 00:00:00      \\N  7127846   326315   \n",
       "16690     7244716  7115834  2022-04-20 00:00:00      \\N  7127846  3527650   \n",
       "16691     7244716  7115834  2022-04-20 00:00:00      \\N  7127846  2233380   \n",
       "16692     7244716  7115834  2022-04-20 00:00:00      \\N  7127846  2912231   \n",
       "16693     5868605  7115834  2022-04-20 00:00:00      \\N  2403603  9466358   \n",
       "16694     3487610  7115834  2022-04-20 00:00:00      \\N  4899079   401394   \n",
       "16729      867437  7115834  2022-04-20 00:00:00      \\N  6996629  3734122   \n",
       "16730      867437  7115834  2022-04-20 00:00:00      \\N  6996629  4000204   \n",
       "16731      867437  7115834  2022-04-20 00:00:00      \\N  6996629  3338879   \n",
       "\n",
       "      Name_Plat Product_period Region_Plat  \n",
       "16689        \\N             \\N          \\N  \n",
       "16690        \\N             \\N          \\N  \n",
       "16691        \\N             \\N          \\N  \n",
       "16692        \\N             \\N          \\N  \n",
       "16693        \\N             \\N          \\N  \n",
       "16694        \\N             \\N          \\N  \n",
       "16729        \\N             \\N          \\N  \n",
       "16730        \\N             \\N          \\N  \n",
       "16731        \\N             \\N          \\N  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext1[(ext1.id_own == test_id) & (ext1.date_fishery.str.contains('2022-04-20'))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 3260798 entries, 0 to 3260797\n",
      "Data columns (total 9 columns):\n",
      " #   Column          Dtype \n",
      "---  ------          ----- \n",
      " 0   id_fishery      int64 \n",
      " 1   id_own          int64 \n",
      " 2   date_fishery    object\n",
      " 3   numPart         object\n",
      " 4   id_Plat         int64 \n",
      " 5   id_vsd          int64 \n",
      " 6   Name_Plat       object\n",
      " 7   Product_period  object\n",
      " 8   Region_Plat     object\n",
      "dtypes: int64(4), object(5)\n",
      "memory usage: 223.9+ MB\n"
     ]
    }
   ],
   "source": [
    "ext1.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8482136"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_vsd = ext1[ext1.id_own == test_id].id_vsd.iloc[0]\n",
    "test_vsd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_fishery</th>\n",
       "      <th>id_own</th>\n",
       "      <th>date_fishery</th>\n",
       "      <th>numPart</th>\n",
       "      <th>id_Plat</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>Name_Plat</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>Region_Plat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>608483</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>660693</td>\n",
       "      <td>8482136</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>608483</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>660693</td>\n",
       "      <td>8373714</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>608483</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>660693</td>\n",
       "      <td>7280720</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>608483</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>660693</td>\n",
       "      <td>6399168</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>4128905</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>8712885</td>\n",
       "      <td>436652</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3260475</th>\n",
       "      <td>608483</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2021-01-01 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>660693</td>\n",
       "      <td>8333076</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3260522</th>\n",
       "      <td>4605901</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2020-12-31 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>7619579</td>\n",
       "      <td>1578396</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3260794</th>\n",
       "      <td>3458281</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2020-12-29 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>906811</td>\n",
       "      <td>6111511</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3260795</th>\n",
       "      <td>3458281</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2020-12-29 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>906811</td>\n",
       "      <td>3138810</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3260796</th>\n",
       "      <td>3458281</td>\n",
       "      <td>7115834</td>\n",
       "      <td>2020-12-29 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>906811</td>\n",
       "      <td>2081767</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6047 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         id_fishery   id_own         date_fishery numPart  id_Plat   id_vsd  \\\n",
       "9            608483  7115834  2022-05-24 00:00:00      \\N   660693  8482136   \n",
       "10           608483  7115834  2022-05-24 00:00:00      \\N   660693  8373714   \n",
       "11           608483  7115834  2022-05-24 00:00:00      \\N   660693  7280720   \n",
       "12           608483  7115834  2022-05-24 00:00:00      \\N   660693  6399168   \n",
       "13          4128905  7115834  2022-05-24 00:00:00      \\N  8712885   436652   \n",
       "...             ...      ...                  ...     ...      ...      ...   \n",
       "3260475      608483  7115834  2021-01-01 00:00:00      \\N   660693  8333076   \n",
       "3260522     4605901  7115834  2020-12-31 00:00:00      \\N  7619579  1578396   \n",
       "3260794     3458281  7115834  2020-12-29 00:00:00      \\N   906811  6111511   \n",
       "3260795     3458281  7115834  2020-12-29 00:00:00      \\N   906811  3138810   \n",
       "3260796     3458281  7115834  2020-12-29 00:00:00      \\N   906811  2081767   \n",
       "\n",
       "        Name_Plat Product_period Region_Plat  \n",
       "9              \\N             \\N          \\N  \n",
       "10             \\N             \\N          \\N  \n",
       "11             \\N             \\N          \\N  \n",
       "12             \\N             \\N          \\N  \n",
       "13             \\N             \\N          \\N  \n",
       "...           ...            ...         ...  \n",
       "3260475        \\N             \\N          \\N  \n",
       "3260522        \\N             \\N          \\N  \n",
       "3260794        \\N             \\N          \\N  \n",
       "3260795        \\N             \\N          \\N  \n",
       "3260796        \\N             \\N          \\N  \n",
       "\n",
       "[6047 rows x 9 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext1[ext1.id_own == test_id]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>id_fish</th>\n",
       "      <th>fish</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3114848</th>\n",
       "      <td>8482136</td>\n",
       "      <td>1962367</td>\n",
       "      <td>400</td>\n",
       "      <td>минтай</td>\n",
       "      <td>2022-05-24 23:43:01</td>\n",
       "      <td>29756</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id_vsd  num_vsd  id_fish    fish            date_vsd  volume unit\n",
       "3114848  8482136  1962367      400  минтай 2022-05-24 23:43:01   29756   \\N"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext2[ext2.id_vsd == test_vsd]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_prod_designate</th>\n",
       "      <th>id_prod_type</th>\n",
       "      <th>prod_volume</th>\n",
       "      <th>prod_board_volume</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id_ves</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4524386</th>\n",
       "      <td>476</td>\n",
       "      <td>1345203</td>\n",
       "      <td>7886.943</td>\n",
       "      <td>81866.738</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id_prod_designate  id_prod_type  prod_volume  prod_board_volume\n",
       "id_ves                                                                  \n",
       "4524386                476       1345203     7886.943          81866.738"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "product[product.id_ves == 4524386].groupby('id_ves').sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>date</th>\n",
       "      <th>id_prod_designate</th>\n",
       "      <th>id_prod_type</th>\n",
       "      <th>prod_volume</th>\n",
       "      <th>prod_board_volume</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>368</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>3964</td>\n",
       "      <td>0.161</td>\n",
       "      <td>4.485</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>369</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>3524</td>\n",
       "      <td>18.172</td>\n",
       "      <td>352.446</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>370</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2606</td>\n",
       "      <td>1.785</td>\n",
       "      <td>29.438</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>371</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2472</td>\n",
       "      <td>0.437</td>\n",
       "      <td>9.798</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3398</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-01-02</td>\n",
       "      <td>1</td>\n",
       "      <td>3964</td>\n",
       "      <td>0.598</td>\n",
       "      <td>5.083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341714</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>1</td>\n",
       "      <td>1472</td>\n",
       "      <td>0.000</td>\n",
       "      <td>11.109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341715</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>1</td>\n",
       "      <td>2472</td>\n",
       "      <td>0.000</td>\n",
       "      <td>4.922</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341716</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>1</td>\n",
       "      <td>2606</td>\n",
       "      <td>0.000</td>\n",
       "      <td>37.068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341717</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>1</td>\n",
       "      <td>3524</td>\n",
       "      <td>0.000</td>\n",
       "      <td>916.570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341718</th>\n",
       "      <td>4524386</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>1</td>\n",
       "      <td>3964</td>\n",
       "      <td>0.000</td>\n",
       "      <td>2.576</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>476 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         id_ves        date  id_prod_designate  id_prod_type  prod_volume  \\\n",
       "368     4524386  2022-01-01                  1          3964        0.161   \n",
       "369     4524386  2022-01-01                  1          3524       18.172   \n",
       "370     4524386  2022-01-01                  1          2606        1.785   \n",
       "371     4524386  2022-01-01                  1          2472        0.437   \n",
       "3398    4524386  2022-01-02                  1          3964        0.598   \n",
       "...         ...         ...                ...           ...          ...   \n",
       "341714  4524386  2022-04-07                  1          1472        0.000   \n",
       "341715  4524386  2022-04-07                  1          2472        0.000   \n",
       "341716  4524386  2022-04-07                  1          2606        0.000   \n",
       "341717  4524386  2022-04-07                  1          3524        0.000   \n",
       "341718  4524386  2022-04-07                  1          3964        0.000   \n",
       "\n",
       "        prod_board_volume  \n",
       "368                 4.485  \n",
       "369               352.446  \n",
       "370                29.438  \n",
       "371                 9.798  \n",
       "3398                5.083  \n",
       "...                   ...  \n",
       "341714             11.109  \n",
       "341715              4.922  \n",
       "341716             37.068  \n",
       "341717            916.570  \n",
       "341718              2.576  \n",
       "\n",
       "[476 rows x 6 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "product[product.id_ves == 4524386]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 395071 entries, 0 to 395070\n",
      "Data columns (total 6 columns):\n",
      " #   Column             Non-Null Count   Dtype  \n",
      "---  ------             --------------   -----  \n",
      " 0   id_ves             395071 non-null  int64  \n",
      " 1   date               395071 non-null  object \n",
      " 2   id_prod_designate  395071 non-null  int64  \n",
      " 3   id_prod_type       395071 non-null  int64  \n",
      " 4   prod_volume        395071 non-null  float64\n",
      " 5   prod_board_volume  395071 non-null  float64\n",
      "dtypes: float64(2), int64(3), object(1)\n",
      "memory usage: 18.1+ MB\n"
     ]
    }
   ],
   "source": [
    "product.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext_merge = ext1.merge(ext2, on='id_vsd')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext_merge_simp = ext1_simp.merge(ext2_simp, on='id_vsd')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "a = list(catch.columns)\n",
    "a[0] = 'id_fishery'\n",
    "catch.columns = a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3205586, 15)"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext_merge_simp.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext_merge_simp = ext_merge_simp.merge(catch_simp, on='id_ves')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_ves</th>\n",
       "      <th>id_own_x</th>\n",
       "      <th>date_fishery</th>\n",
       "      <th>numPart</th>\n",
       "      <th>id_Plat</th>\n",
       "      <th>id_vsd</th>\n",
       "      <th>Name_Plat</th>\n",
       "      <th>Product_period</th>\n",
       "      <th>Region_Plat</th>\n",
       "      <th>num_vsd</th>\n",
       "      <th>...</th>\n",
       "      <th>date_vsd</th>\n",
       "      <th>volume</th>\n",
       "      <th>unit</th>\n",
       "      <th>date</th>\n",
       "      <th>id_region</th>\n",
       "      <th>id_fish_y</th>\n",
       "      <th>catch_volume</th>\n",
       "      <th>id_regime</th>\n",
       "      <th>permit</th>\n",
       "      <th>id_own_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1657</td>\n",
       "      <td>1175</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6292428</td>\n",
       "      <td>8660287</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>3697783</td>\n",
       "      <td>...</td>\n",
       "      <td>2022-05-24 17:31:35</td>\n",
       "      <td>17522</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-23</td>\n",
       "      <td>264</td>\n",
       "      <td>292</td>\n",
       "      <td>4.497</td>\n",
       "      <td>1</td>\n",
       "      <td>2986</td>\n",
       "      <td>1175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1657</td>\n",
       "      <td>1175</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6292428</td>\n",
       "      <td>8660287</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>3697783</td>\n",
       "      <td>...</td>\n",
       "      <td>2022-05-24 17:31:35</td>\n",
       "      <td>17522</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-24</td>\n",
       "      <td>264</td>\n",
       "      <td>292</td>\n",
       "      <td>10.228</td>\n",
       "      <td>1</td>\n",
       "      <td>2986</td>\n",
       "      <td>1175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1657</td>\n",
       "      <td>1175</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6292428</td>\n",
       "      <td>8660287</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>3697783</td>\n",
       "      <td>...</td>\n",
       "      <td>2022-05-24 17:31:35</td>\n",
       "      <td>17522</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-25</td>\n",
       "      <td>264</td>\n",
       "      <td>292</td>\n",
       "      <td>11.133</td>\n",
       "      <td>1</td>\n",
       "      <td>2986</td>\n",
       "      <td>1175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1657</td>\n",
       "      <td>1175</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6292428</td>\n",
       "      <td>8660287</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>3697783</td>\n",
       "      <td>...</td>\n",
       "      <td>2022-05-24 17:31:35</td>\n",
       "      <td>17522</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-26</td>\n",
       "      <td>264</td>\n",
       "      <td>292</td>\n",
       "      <td>7.760</td>\n",
       "      <td>1</td>\n",
       "      <td>2986</td>\n",
       "      <td>1175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1657</td>\n",
       "      <td>1175</td>\n",
       "      <td>2022-05-24 00:00:00</td>\n",
       "      <td>\\N</td>\n",
       "      <td>6292428</td>\n",
       "      <td>8660287</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "      <td>3697783</td>\n",
       "      <td>...</td>\n",
       "      <td>2022-05-24 17:31:35</td>\n",
       "      <td>17522</td>\n",
       "      <td>\\N</td>\n",
       "      <td>2022-01-27</td>\n",
       "      <td>264</td>\n",
       "      <td>292</td>\n",
       "      <td>2.139</td>\n",
       "      <td>1</td>\n",
       "      <td>2986</td>\n",
       "      <td>1175</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_ves  id_own_x         date_fishery numPart  id_Plat   id_vsd Name_Plat  \\\n",
       "0    1657      1175  2022-05-24 00:00:00      \\N  6292428  8660287        \\N   \n",
       "1    1657      1175  2022-05-24 00:00:00      \\N  6292428  8660287        \\N   \n",
       "2    1657      1175  2022-05-24 00:00:00      \\N  6292428  8660287        \\N   \n",
       "3    1657      1175  2022-05-24 00:00:00      \\N  6292428  8660287        \\N   \n",
       "4    1657      1175  2022-05-24 00:00:00      \\N  6292428  8660287        \\N   \n",
       "\n",
       "  Product_period Region_Plat  num_vsd  ...             date_vsd volume unit  \\\n",
       "0             \\N          \\N  3697783  ...  2022-05-24 17:31:35  17522   \\N   \n",
       "1             \\N          \\N  3697783  ...  2022-05-24 17:31:35  17522   \\N   \n",
       "2             \\N          \\N  3697783  ...  2022-05-24 17:31:35  17522   \\N   \n",
       "3             \\N          \\N  3697783  ...  2022-05-24 17:31:35  17522   \\N   \n",
       "4             \\N          \\N  3697783  ...  2022-05-24 17:31:35  17522   \\N   \n",
       "\n",
       "         date id_region id_fish_y  catch_volume  id_regime  permit  id_own_y  \n",
       "0  2022-01-23       264       292         4.497          1    2986      1175  \n",
       "1  2022-01-24       264       292        10.228          1    2986      1175  \n",
       "2  2022-01-25       264       292        11.133          1    2986      1175  \n",
       "3  2022-01-26       264       292         7.760          1    2986      1175  \n",
       "4  2022-01-27       264       292         2.139          1    2986      1175  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext_merge_simp.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-23-ebc143340526>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mext_merge_simp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'numPart'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'Name_Plat'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'Product_period'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'Region_Plat'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mhead\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36mdrop\u001b[1;34m(self, labels, axis, index, columns, level, inplace, errors)\u001b[0m\n\u001b[0;32m   4306\u001b[0m                 \u001b[0mweight\u001b[0m  \u001b[1;36m1.0\u001b[0m     \u001b[1;36m0.8\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4307\u001b[0m         \"\"\"\n\u001b[1;32m-> 4308\u001b[1;33m         return super().drop(\n\u001b[0m\u001b[0;32m   4309\u001b[0m             \u001b[0mlabels\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mlabels\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4310\u001b[0m             \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36mdrop\u001b[1;34m(self, labels, axis, index, columns, level, inplace, errors)\u001b[0m\n\u001b[0;32m   4151\u001b[0m         \u001b[1;32mfor\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlabels\u001b[0m \u001b[1;32min\u001b[0m \u001b[0maxes\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4152\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0mlabels\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 4153\u001b[1;33m                 \u001b[0mobj\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mobj\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_drop_axis\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlabels\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mlevel\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0merrors\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0merrors\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   4154\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4155\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0minplace\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m_drop_axis\u001b[1;34m(self, labels, axis, level, errors)\u001b[0m\n\u001b[0;32m   4187\u001b[0m             \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4188\u001b[0m                 \u001b[0mnew_axis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlabels\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0merrors\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0merrors\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 4189\u001b[1;33m             \u001b[0mresult\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mreindex\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m**\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0maxis_name\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mnew_axis\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   4190\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4191\u001b[0m         \u001b[1;31m# Case for non-unique axis\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\util\\_decorators.py\u001b[0m in \u001b[0;36mwrapper\u001b[1;34m(*args, **kwargs)\u001b[0m\n\u001b[0;32m    310\u001b[0m         \u001b[1;33m@\u001b[0m\u001b[0mwraps\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mfunc\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    311\u001b[0m         \u001b[1;32mdef\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m*\u001b[0m\u001b[0margs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m->\u001b[0m \u001b[0mCallable\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33m...\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mAny\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 312\u001b[1;33m             \u001b[1;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m*\u001b[0m\u001b[0margs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    313\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    314\u001b[0m         \u001b[0mkind\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0minspect\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mParameter\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mPOSITIONAL_OR_KEYWORD\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36mreindex\u001b[1;34m(self, *args, **kwargs)\u001b[0m\n\u001b[0;32m   4174\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"axis\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4175\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"labels\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 4176\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0msuper\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mreindex\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   4177\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4178\u001b[0m     def drop(\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36mreindex\u001b[1;34m(self, *args, **kwargs)\u001b[0m\n\u001b[0;32m   4791\u001b[0m             )\n\u001b[0;32m   4792\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 4793\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_consolidate_inplace\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   4794\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   4795\u001b[0m         \u001b[1;31m# if all axes that are requested to reindex are equal, then only copy\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m_consolidate_inplace\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m   5539\u001b[0m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mconsolidate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5540\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 5541\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_protect_consolidate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mf\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   5542\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5543\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0mfinal\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m_protect_consolidate\u001b[1;34m(self, f)\u001b[0m\n\u001b[0;32m   5527\u001b[0m         \"\"\"\n\u001b[0;32m   5528\u001b[0m         \u001b[0mblocks_before\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mblocks\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 5529\u001b[1;33m         \u001b[0mresult\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mf\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   5530\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mlen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mblocks\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m!=\u001b[0m \u001b[0mblocks_before\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5531\u001b[0m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_clear_item_cache\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36mf\u001b[1;34m()\u001b[0m\n\u001b[0;32m   5537\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5538\u001b[0m         \u001b[1;32mdef\u001b[0m \u001b[0mf\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 5539\u001b[1;33m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mconsolidate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   5540\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5541\u001b[0m         \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_protect_consolidate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mf\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py\u001b[0m in \u001b[0;36mconsolidate\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    986\u001b[0m         \u001b[0mbm\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mtype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mblocks\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    987\u001b[0m         \u001b[0mbm\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_is_consolidated\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;32mFalse\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 988\u001b[1;33m         \u001b[0mbm\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_consolidate_inplace\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    989\u001b[0m         \u001b[1;32mreturn\u001b[0m \u001b[0mbm\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    990\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py\u001b[0m in \u001b[0;36m_consolidate_inplace\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    991\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_consolidate_inplace\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m->\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    992\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mis_consolidated\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 993\u001b[1;33m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mblocks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mtuple\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0m_consolidate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mblocks\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    994\u001b[0m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_is_consolidated\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    995\u001b[0m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_known_consolidated\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py\u001b[0m in \u001b[0;36m_consolidate\u001b[1;34m(blocks)\u001b[0m\n\u001b[0;32m   1914\u001b[0m     \u001b[0mnew_blocks\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mList\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mBlock\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1915\u001b[0m     \u001b[1;32mfor\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0m_can_consolidate\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mgroup_blocks\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mgrouper\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 1916\u001b[1;33m         merged_blocks = _merge_blocks(\n\u001b[0m\u001b[0;32m   1917\u001b[0m             \u001b[0mlist\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mgroup_blocks\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mdtype\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mcan_consolidate\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0m_can_consolidate\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1918\u001b[0m         )\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py\u001b[0m in \u001b[0;36m_merge_blocks\u001b[1;34m(blocks, dtype, can_consolidate)\u001b[0m\n\u001b[0;32m   1937\u001b[0m         \u001b[1;31m# combination of those slices is a slice, too.\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1938\u001b[0m         \u001b[0mnew_mgr_locs\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mconcatenate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mb\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmgr_locs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mas_array\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mb\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mblocks\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 1939\u001b[1;33m         \u001b[0mnew_values\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mvstack\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mb\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mvalues\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mb\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mblocks\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   1940\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1941\u001b[0m         \u001b[0margsort\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0margsort\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mnew_mgr_locs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m<__array_function__ internals>\u001b[0m in \u001b[0;36mvstack\u001b[1;34m(*args, **kwargs)\u001b[0m\n",
      "\u001b[1;32mc:\\ProgramData\\Anaconda3\\lib\\site-packages\\numpy\\core\\shape_base.py\u001b[0m in \u001b[0;36mvstack\u001b[1;34m(tup)\u001b[0m\n\u001b[0;32m    281\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0marrs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlist\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    282\u001b[0m         \u001b[0marrs\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m[\u001b[0m\u001b[0marrs\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 283\u001b[1;33m     \u001b[1;32mreturn\u001b[0m \u001b[0m_nx\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mconcatenate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0marrs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    284\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    285\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m<__array_function__ internals>\u001b[0m in \u001b[0;36mconcatenate\u001b[1;34m(*args, **kwargs)\u001b[0m\n",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "ext_merge_simp.drop(columns=['numPart', 'Name_Plat', 'Product_period', 'Region_Plat']).head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ext_merge_simp[['id_own_x', 'date_fishery', 'Product_period', 'date', 'catch_volume', 'volume']].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['id_ves', 'id_own_x', 'date_fishery', 'numPart', 'id_Plat', 'id_vsd',\n",
       "       'Name_Plat', 'Product_period', 'Region_Plat', 'num_vsd', 'id_fish_x',\n",
       "       'fish', 'date_vsd', 'volume', 'unit', 'date', 'id_region', 'id_fish_y',\n",
       "       'catch_volume', 'id_regime', 'permit', 'id_own_y'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ext_merge_simp.columns\n"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "ad2bdc8ecc057115af97d19610ffacc2b4e99fae6737bb82f5d7fb13d2f2c186"
  },
  "kernelspec": {
   "display_name": "Python 3.8.8 ('base')",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
